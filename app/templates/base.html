<!doctype html>
<html lang="en" class="light" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8"/>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>
        Expense Tracker
    </title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}"/>
</head>
<body class="bg-gray-100 text-gray-800">
    <nav class="bg-blue-600 text-white p-4 flex justify-between">
        <div class="font-bold text-xl">
            Expense Tracker
        </div>
        <div class="space-x-4">
            <a href="{{ url_for('index') }}" class="hover:underline"><b>Home</b></a>
            {% if current_user.is_authenticated %}
                <a href="{{ url_for('expenses.list_expenses') }}" class="hover:underline"><b>Dashboard</b></a>
                <a href="{{ url_for('budgets.list_budgets') }}" class="hover:underline"><b>Budgets</b></a>
                <a href="{{ url_for('auth.logout') }}" class="hover:underline"><b>Logout</b></a>
                <a href="{{ url_for('notifications.list_notifications') }}" class="relative">
                  ðŸ””
                  {% if current_user.is_authenticated and current_user.notifications|selectattr('read', 'equalto', False)|list|length > 0 %}
                    <span class="absolute -top-1 -right-1 bg-red-600 text-white text-xs rounded-full px-1">
                      {{ current_user.notifications|selectattr('read', 'equalto', False)|list|length }}
                    </span>
                  {% endif %}
                </a>

            {% else %}
                <a href="{{ url_for('auth.login') }}" class="hover:underline"><b>Login</b></a>
                <a href="{{ url_for('auth.register') }}" class="hover:underline"><b>Register</b></a>
            {% endif %}
        </div>
    </nav>

    <div class="max-w-4xl mx-auto p-4">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div id="flash-messages" class="space-y-2 mb-4"></div>
                    {% for category, message in messages %}
                        <div class="relative px-4 py-3 rounded shadow flex items-center justify-between
                            {% if category == 'success' %} bg-green-100 text-green-800
                            {% elif category == 'error' %} bg-red-100 text-red-800
                            {% elif category == 'warning' %} bg-yellow-100 text-yellow-800
                            {% else %} bg-blue-100 text-blue-800 {% endif %}">
                            <span>{{ message }}</span>
                            <button onclick="this.parentElement.remove();" class="ml-4 text-xl leading-none">&times;</button>
                        </div>
                    {% endfor %}
            {% endif %}
        {% endwith %}
    </div>
<main class="max-w-4xl mx-auto p-4">

    {% block content %}{% endblock %}

</main>
<footer class="text-center text-sm text-gray-600 py-4">
    <p>&copy; 2025 Expense Tracker</p>
</footer>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</body>
</html>